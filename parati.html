<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Para Ti ‚ù§Ô∏è</title>
<style>
  :root{
    --bg1:#ffdde1;
    --bg2:#ee9ca7;
    --ink:#4b0b2f;
    --accent:#ff3b6e;
    --card:#fff7fb;
  }

  /* üîπ Reset y control de scroll */
  *{
    box-sizing:border-box;
    max-width: 100%;   /* evita que algo se pase del ancho */
  }
  html,body{
    height:100%;
    margin:0;
    padding:0;
    overflow-x: hidden;  /* ‚ùå desactiva scroll horizontal */
    overflow-y: auto;    /* ‚úÖ solo scroll vertical */
    width:100%;
  }

  body{
    font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    color:var(--ink);
    background: radial-gradient(1200px 800px at 50% -10%, var(--bg2), var(--bg1));
  }

  /* Fondo de corazones flotantes */
  .hearts{
    position:fixed; inset:0; pointer-events:none; overflow:hidden;
    z-index:0; opacity:0.8;
  }
  .heart{
    position:absolute; bottom:-10vh;
    animation: floatUp linear infinite;
    will-change: transform, opacity;
    filter: drop-shadow(0 10px 6px rgba(0,0,0,.12));
    user-select:none;
  }
  .heart span{display:block; transform: rotate(10deg);}
  @keyframes floatUp{
    0%{ transform: translateY(0) scale(0.8); opacity:0 }
    10%{opacity:.8}
    100%{ transform: translateY(-120vh) scale(1.2); opacity:0 }
  }

  /* Tarjeta */
  .card{
    position:relative;
    width:min(720px, 92vw);
    margin: 8vh auto 14vh;
    background: var(--card);
    border-radius: 24px;
    padding: clamp(18px, 3vw, 28px) clamp(18px, 3vw, 28px) clamp(36px, 4vw, 64px);
    box-shadow: 0 20px 60px rgba(233, 22, 94, .25);
    text-align:center;
    z-index:2;
  }
  h1{
    margin: 6px 0 2px;
    font-size: clamp(26px, 6vw, 44px);
    letter-spacing: .5px;
  }
  .sub{opacity:.7; margin-top:2px; font-size:clamp(12px, 2.4vw, 14px)}
  .big-heart{
    font-size: clamp(64px, 18vw, 150px);
    line-height:1;
    animation: latido 1s infinite;
  }
  @keyframes latido{
    0%,100%{ transform: scale(1) }
    50%{ transform: scale(1.15) }
  }
  button{
    appearance:none; border:0; cursor:pointer;
    background: linear-gradient(90deg, #ff6a88, #ff99ac);
    color:white; font-weight:700;
    padding: 14px 22px; border-radius: 999px;
    box-shadow: 0 8px 20px rgba(255,59,110,.35);
    transition: transform .08s ease, filter .2s ease;
    font-size: 16px;
  }
  button:hover{ filter: brightness(1.02) }
  button:active{ transform: translateY(1px) scale(.99) }

  .hidden{ display:none !important }

  .msg{
    margin: 14px auto 0;
    font-size: clamp(16px, 4vw, 20px);
    max-width: 58ch;
    min-height: 5lh;
    white-space: pre-wrap;
  }
  .footer-note{
    margin-top: 22px;
    margin-bottom: 10px;
    font-size: 12px;
    opacity:.55;
  }

  /* Canvas de confeti de corazones */
  .burst{
    position:absolute; inset:0; pointer-events:none; z-index:1;
  }

  .row{ display:flex; align-items:center; justify-content:center; gap:10px; flex-wrap:wrap; }

  /* Foto rom√°ntica */
  .foto-container{ margin-top: 24px; }
  .foto-romantica{
    width: 240px;
    border-radius: 20px;
    margin: 0 auto;
    display: block;
    box-shadow: 0 12px 35px rgba(0,0,0,.30);
    opacity: 0;
    transform: scale(.85) translateY(8px);
  }
  .foto-romantica.reveal{
    animation: aparecer 1.8s ease forwards, flotar 8s ease-in-out 1.8s infinite;
  }
  @keyframes aparecer{
    to{ opacity:1; transform: scale(1) translateY(0); }
  }
  @keyframes flotar{
    0%,100%{ transform: translateY(0); }
    50%{ transform: translateY(-10px); }
  }
</style>
</head>
<body>
  <div class="hearts" id="hearts"></div>

  <div class="card">
    <div class="big-heart">‚ù§Ô∏è</div>
    <h1 id="title">Para Ti ‚ù§Ô∏è</h1>
    <div class="sub" id="subtitle">Toca el bot√≥n para abrir tu cartita</div>
    <div class="row" style="margin-top:12px;">
      <button id="startBtn">Abrir carta üíå</button>
      <button id="shareBtn" disabled style="cursor: default; opacity: 0.9;">Te Quiero ‚ù§Ô∏è</button>
    </div>

    <div id="content" class="hidden">
      <div class="msg" id="message"></div>
      <div class="row" style="margin-top:12px;">
        <button id="surpriseBtn">De mi para Tiüíò</button>
      </div>

      <div class="foto-container hidden">
        <img
          src="https://gustavolezana.github.io/mi-cancion/mifoto.jpeg"
          alt="Nuestra foto ‚ù§Ô∏è"
          id="fotoRomantica"
          class="foto-romantica">
      </div>

      <div class="footer-note" id="footer"></div>
    </div>
    <canvas class="burst" id="burst" width="800" height="500"></canvas>
  </div>

  <audio id="musica" preload="auto" playsinline loop>
    <source src="https://gustavolezana.github.io/mi-cancion/TikVid.io_7539316207938325781.mp3" type="audio/mpeg">
  </audio>

<script>
  const CONFIG = {
    nombre: "Mi Amor",
    titulo: "Para Ti, Estefany ‚ù§Ô∏è",
    subtitulo: "Toca el bot√≥n para abrir tu cartita amorcito",
    mensaje: [
      "Gracias por estar a mi lado Estefany.",
      "Eres mi persona favorita en todo el universo.",
      "te quiero mucho, quiero que sepas que eres muy",
      "especial para mi, no tengas ‚ô• dudas ",
      "como dice la letra admiro mucho como enfrentas todo",
      "quiero ser el refugio donde puedas estar feliz",
      "es raro encontrar a alguien con un corazon tan grande como el tuyo",
      "por eso me es dificil creer pero en todo este",
      "tiempo te quiero cada ves mas y es lo que da Miedo",
      "pero ahi voy de cabeza metido contigo",
      "mientras mas paso contigo mas me encari√±o",
      "te vuelves cada ves algo muy importante para",
      "quiero que sepas que de verdad te quiero muchisisisismo‚ò∫",
      "19/05/2025 ‚ô•‚ô•‚ô•",
      "Hoy, y para siempre: te quiero. ‚ù§Ô∏è"
    ],
    firma: "Hecho con ‚ô• por Gustavo Tu Enamorado",
    musica: false,
    corazones: 18
  };

  const title = document.getElementById('title');
  const subtitle = document.getElementById('subtitle');
  const startBtn = document.getElementById('startBtn');
  const content = document.getElementById('content');
  const messageEl = document.getElementById('message');
  const footer = document.getElementById('footer');
  const heartsLayer = document.getElementById('hearts');
  const burstCanvas = document.getElementById('burst');
  const burstCtx = burstCanvas.getContext('2d');
  const shareBtn = document.getElementById('shareBtn');
  const surpriseBtn = document.getElementById('surpriseBtn');
  const musicaEl = document.getElementById('musica');
  const fotoContainer = document.querySelector('.foto-container');
  const fotoRomantica = document.getElementById('fotoRomantica');

  function sizeCanvas(){
    const rect = burstCanvas.parentElement.getBoundingClientRect();
    burstCanvas.width = Math.floor(rect.width * (window.devicePixelRatio||1));
    burstCanvas.height = Math.floor(rect.height * (window.devicePixelRatio||1));
  }
  sizeCanvas();
  window.addEventListener('resize', sizeCanvas);

  function fillTemplate(str){ return str.replaceAll("{{nombre}}", CONFIG.nombre); }
  title.textContent = fillTemplate(CONFIG.titulo);
  subtitle.textContent = CONFIG.subtitulo;
  footer.textContent = fillTemplate(CONFIG.firma);

  function makeHearts(){
    heartsLayer.innerHTML = "";
    const N = CONFIG.corazones;
    const colors = ["#ff3366","#ff6b9a","#ff99ac","#ff4d6d","#e91e63"];
    for(let i=0;i<N;i++){
      const el = document.createElement('div');
      el.className = 'heart';
      const span = document.createElement('span');
      span.textContent = "‚ù§";
      el.appendChild(span);

      const left = Math.random()*100;
      const dur = 18 + Math.random()*18;
      const delay = Math.random()*-20;
      const size = 16 + Math.random()*42;

      el.style.left = left + "vw";
      el.style.animationDuration = dur + "s";
      el.style.animationDelay = delay + "s";
      el.style.fontSize = size + "px";
      el.style.color = colors[Math.floor(Math.random()*colors.length)];
      heartsLayer.appendChild(el);
    }
  }
  makeHearts();

  async function typeLines(lines, el, speed=50){
    el.textContent = "";
    for(const line of lines){
      for(const ch of line){
        el.textContent += ch;
        await new Promise(r=>setTimeout(r, speed));
      }
      el.textContent += "\n";
      await new Promise(r=>setTimeout(r, 250));
    }
  }

  function burst(x, y){
    const ctx = burstCtx;
    const dpr = window.devicePixelRatio||1;
    const particles = [];
    const count = 28;
    for(let i=0;i<count;i++){
      const angle = (Math.PI*2)*Math.random();
      const speed = 1.5 + Math.random()*3.5;
      particles.push({
        x:x*dpr, y:y*dpr,
        vx: Math.cos(angle)*speed*dpr,
        vy: Math.sin(angle)*speed*dpr - 2,
        life: 60 + Math.random()*30,
        size: 10 + Math.random()*10,
        color: `hsl(${Math.floor(330+Math.random()*40)}, 90%, 60%)`
      });
    }
    let frame=0;
    (function anim(){
      frame++;
      ctx.clearRect(0,0,burstCanvas.width, burstCanvas.height);
      particles.forEach(p=>{
        p.vy += 0.06*dpr;
        p.x += p.vx; p.y += p.vy; p.life--;
        ctx.save();
        ctx.translate(p.x, p.y);
        ctx.rotate(frame/20 + (p.x+p.y)*0.0005);
        ctx.fillStyle = p.color;
        const s = p.size;
        ctx.beginPath();
        ctx.moveTo(0, s*0.35);
        ctx.bezierCurveTo(s*0.8, -s*0.4, s*1.6, s*0.6, 0, s*1.6);
        ctx.bezierCurveTo(-s*1.6, s*0.6, -s*0.8, -s*0.4, 0, s*0.35);
        ctx.fill();
        ctx.restore();
      });
      if(particles.some(p=>p.life>0)) requestAnimationFrame(anim);
      else ctx.clearRect(0,0,burstCanvas.width, burstCanvas.height);
    })();
  }

  startBtn.addEventListener('click', async (e)=>{
    startBtn.classList.add('hidden');
    document.getElementById('shareBtn').classList.add('hidden');
    content.classList.remove('hidden');

    try { musicaEl.volume = 1; await musicaEl.play(); }
    catch(err) { console.log("Autoplay bloqueado.", err); }

    await typeLines(CONFIG.mensaje.map(line=>fillTemplate(line)), messageEl, 50);

    fotoContainer.classList.remove('hidden');
    void fotoRomantica.offsetWidth;
    fotoRomantica.classList.add('reveal');

    const rect = e.target.getBoundingClientRect();
    burst(rect.left + rect.width/2, rect.top + rect.height/2 + window.scrollY);
  });

  surpriseBtn.addEventListener('click', ()=>{
    musicaEl.play().catch(()=>{});
    burst(window.innerWidth/2, (window.innerHeight*0.18));
  });
</script>
</body>
</html>